{
  "info": {
    "name": "TranSync 客户端完整API (包含Inbound)",
    "description": "TranSync系统客户端所有API接口的完整集合，包括认证、入站管理、预报单、包裹管理、Inbound操作等功能",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "01. 用户认证",
      "item": [
        {
          "name": "客户登录",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"client001\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/login",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "login"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.token) {",
                  "        pm.environment.set('client_token', response.token);",
                  "        console.log('客户端Token已保存:', response.token);",
                  "        if (response.user && response.user.id) {",
                  "            pm.environment.set('client_id', response.user.id);",
                  "            console.log('客户端ID已保存:', response.user.id);",
                  "        }",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "客户信息",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/profile",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "profile"]
            }
          },
          "response": []
        },
        {
          "name": "客户端测试",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/test",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "test"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "02. Inbound 入站管理",
      "item": [
        {
          "name": "创建入站 (Inbound)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"shipping_type\": \"air\",\n  \"clearance_type\": \"general_trade\",\n  \"tax_type_id\": 1,\n  \"arrival_method\": \"express\",\n  \"remark\": \"测试入站\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/create-inbond",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "create-inbond"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.inbond && response.inbond.id) {",
                  "        pm.environment.set('inbond_id', response.inbond.id);",
                  "        pm.environment.set('inbond_code', response.inbond.inbond_code);",
                  "        console.log('入站ID已保存:', response.inbond.id);",
                  "        console.log('入站代码已保存:', response.inbond.inbond_code);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "获取入站列表 (Inbound List)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/inbonds?page=1&limit=20",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "inbonds"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "status",
                  "value": "draft",
                  "disabled": true
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "获取入站详情 (Inbound Details)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "inbond", "{{inbond_id}}"]
            }
          },
          "response": []
        },
        {
          "name": "更新入站信息 (Update Inbound)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"shipping_type\": \"sea\",\n  \"arrival_method\": \"ocean_freight\",\n  \"remark\": \"更新后的入站信息\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "inbond", "{{inbond_id}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "03. Inbound 包裹管理",
      "item": [
        {
          "name": "添加包裹到入站",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"length_cm\": 30,\n  \"width_cm\": 20,\n  \"height_cm\": 15,\n  \"weight_kg\": 2.5,\n  \"split_action\": \"direct\",\n  \"remark\": \"测试包裹\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/add-package",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "inbond",
                "{{inbond_id}}",
                "add-package"
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.package && response.package.id) {",
                  "        pm.environment.set('package_id', response.package.id);",
                  "        pm.environment.set('package_code', response.package.package_code);",
                  "        pm.environment.set('last_package_id', response.package.id);",
                  "        pm.environment.set('last_package_code', response.package.package_code);",
                  "        console.log('包裹ID已保存:', response.package.id);",
                  "        console.log('包裹代码已保存:', response.package.package_code);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "批量添加包裹到入站",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"packages\": [\n    {\n      \"length_cm\": 30,\n      \"width_cm\": 20,\n      \"height_cm\": 15,\n      \"weight_kg\": 2.5,\n      \"split_action\": \"direct\",\n      \"remark\": \"批量测试包裹1\"\n    },\n    {\n      \"length_cm\": 25,\n      \"width_cm\": 25,\n      \"height_cm\": 20,\n      \"weight_kg\": 3.0,\n      \"split_action\": \"direct\",\n      \"remark\": \"批量测试包裹2\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/add-packages-batch",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "inbond",
                "{{inbond_id}}",
                "add-packages-batch"
              ]
            }
          },
          "response": []
        },
        {
          "name": "获取入站包裹列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/packages",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "inbond", "{{inbond_id}}", "packages"]
            }
          },
          "response": []
        },
        {
          "name": "更新包裹信息",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"length_cm\": 35,\n  \"width_cm\": 25,\n  \"height_cm\": 18,\n  \"weight_kg\": 3.0,\n  \"split_action\": \"split\",\n  \"remark\": \"更新后的包裹信息\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "package", "{{package_id}}"]
            }
          },
          "response": []
        },
        {
          "name": "批量更新包裹",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"packages\": [\n    {\n      \"id\": {{package_id}},\n      \"length_cm\": 32,\n      \"width_cm\": 22,\n      \"height_cm\": 16,\n      \"weight_kg\": 2.8,\n      \"remark\": \"批量更新包裹1\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/packages-batch",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "packages-batch"]
            }
          },
          "response": []
        },
        {
          "name": "删除包裹",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "package", "{{package_id}}"]
            }
          },
          "response": []
        },
        {
          "name": "批量删除包裹",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"packageIds\": [{{package_id}}]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/packages-batch",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "packages-batch"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "04. Inbound 包裹项目管理",
      "item": [
        {
          "name": "添加包裹项目",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tracking_no\": \"TRK123456789\",\n  \"client_code\": \"CLI001\",\n  \"file_number\": \"FILE001\",\n  \n  \"receiver_name\": \"张三\",\n  \"receiver_country\": \"中国\",\n  \"receiver_state\": \"广东省\",\n  \"receiver_city\": \"深圳市\",\n  \"receiver_postcode\": \"518000\",\n  \"receiver_email\": \"zhang@example.com\",\n  \"receiver_phone\": \"13800138000\",\n  \"receiver_address1\": \"南山区科技园\",\n  \"receiver_address2\": \"\",\n  \n  \"sender_name\": \"发送者\",\n  \"sender_country\": \"美国\",\n  \"sender_province\": \"加利福尼亚州\",\n  \"sender_city\": \"洛杉矶\",\n  \"sender_postcode\": \"90210\",\n  \"sender_address1\": \"123 Main St\",\n  \"sender_license\": \"LICENSE123\",\n  \"sender_email\": \"sender@example.com\",\n  \"sender_phone\": \"+1234567890\",\n  \n  \"weight_kg\": 1.5,\n  \"quantity\": 1,\n  \"length_cm\": 20,\n  \"width_cm\": 15,\n  \"height_cm\": 10,\n  \n  \"hs_code\": \"8471301000\",\n  \"product_name_en\": \"Computer Accessories\",\n  \"product_description\": \"USB Cable\",\n  \"origin_country\": \"中国\",\n  \"url\": \"https://example.com/product\",\n  \n  \"unit_price\": 25.00,\n  \"total_price\": 25.00,\n  \"item_count\": 1,\n  \n  \"is_fda\": false,\n  \"manufacturer_mid\": \"MFG123\",\n  \"custom_note\": \"特殊说明\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_code}}/add-item",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "package",
                "{{package_code}}",
                "add-item"
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.packageItem && response.packageItem.id) {",
                  "        pm.environment.set('package_item_id', response.packageItem.id);",
                  "        console.log('包裹项目ID已保存:', response.packageItem.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "获取包裹项目列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_code}}/items",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "package", "{{package_code}}", "items"]
            }
          },
          "response": []
        },
        {
          "name": "从Excel批量添加项目",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"items\": [\n    {\n      \"package_id\": 1,\n      \"tracking_no\": \"TRK123456789\",\n      \"client_code\": \"CLI001\",\n      \"receiver_name\": \"张三\",\n      \"receiver_country\": \"中国\",\n      \"receiver_city\": \"深圳市\",\n      \"product_name_en\": \"Computer Accessories\",\n      \"total_price\": 25.00\n    },\n    {\n      \"package_id\": 2,\n      \"tracking_no\": \"TRK987654321\",\n      \"client_code\": \"CLI002\",\n      \"receiver_name\": \"李四\",\n      \"receiver_country\": \"中国\",\n      \"receiver_city\": \"广州市\",\n      \"product_name_en\": \"Mobile Phone Case\",\n      \"total_price\": 15.00\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/add-items-from-excel",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "inbond",
                "{{inbond_id}}",
                "add-items-from-excel"
              ]
            }
          },
          "response": []
        },
        {
          "name": "获取入站所有项目",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/items",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "inbond", "{{inbond_id}}", "items"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "05. 预报单管理 (Forecasts)",
      "item": [
        {
          "name": "获取预报单列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/forecasts?page=1&limit=20",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "forecasts"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "status",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "mawb",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "flight_no",
                  "value": "",
                  "disabled": true
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "获取预报单详情",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/forecasts/{{forecast_id}}?page=1&limit=50",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "forecasts", "{{forecast_id}}"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "50"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "获取包裹统计信息",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/forecasts/stats",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "forecasts", "stats"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "06. 包裹查询 (Packages)",
      "item": [
        {
          "name": "获取所有包裹列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/packages",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "packages"]
            }
          },
          "response": []
        },
        {
          "name": "获取包裹详情",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/packages/{{package_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "packages", "{{package_id}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "07. 系统接口",
      "item": [
        {
          "name": "健康检查",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/health",
              "host": ["{{base_url}}"],
              "path": ["api", "health"]
            }
          },
          "response": []
        },
        {
          "name": "客户端主页",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client",
              "host": ["{{base_url}}"],
              "path": ["api", "client"]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// 预请求脚本",
          "console.log('发送请求:', pm.request.url.toString());"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// 全局测试脚本",
          "console.log('响应状态:', pm.response.code, pm.response.status);",
          "",
          "// 检查通用错误",
          "if (pm.response.code === 401) {",
          "    console.warn('认证失败，请重新登录');",
          "} else if (pm.response.code === 403) {",
          "    console.warn('权限不足');",
          "} else if (pm.response.code >= 500) {",
          "    console.error('服务器错误');",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    }
  ]
}
