{
  "info": {
    "_postman_id": "client-api-collection-001",
    "name": "TranSync Client API Collection",
    "description": "客户端API接口集合 - 包含登录、预报单查询、包裹管理等功能",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "transync-client"
  },
  "item": [
    {
      "name": "01. 客户端认证",
      "item": [
        {
          "name": "客户端登录",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.environment.set('client_token', responseJson.token);",
                  "    pm.environment.set('client_id', responseJson.user.id);",
                  "    pm.environment.set('client_name', responseJson.user.customerName);",
                  "    console.log('Token saved:', responseJson.token.substring(0, 50) + '...');",
                  "    console.log('Client ID:', responseJson.user.id);",
                  "    console.log('Client Name:', responseJson.user.customerName);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"{{client_username}}\",\n    \"password\": \"{{client_password}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/common/auth/login/client",
              "host": ["{{base_url}}"],
              "path": ["api", "common", "auth", "login", "client"]
            },
            "description": "客户端用户登录获取JWT token"
          },
          "response": []
        },
        {
          "name": "验证客户端Token",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/",
              "host": ["{{base_url}}"],
              "path": ["api", "client", ""]
            },
            "description": "验证客户端token是否有效，获取用户信息"
          },
          "response": []
        }
      ],
      "description": "客户端认证相关接口"
    },
    {
      "name": "02. 客户端仪表板",
      "item": [
        {
          "name": "客户端仪表板",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/",
              "host": ["{{base_url}}"],
              "path": ["api", "client", ""]
            },
            "description": "获取客户端仪表板信息"
          },
          "response": []
        },
        {
          "name": "客户端测试路由",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/test",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "test"]
            },
            "description": "测试客户端路由连接"
          },
          "response": []
        }
      ],
      "description": "客户端仪表板相关接口"
    },
    {
      "name": "03. 预报单管理",
      "item": [
        {
          "name": "获取预报单列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/forecasts?page=1&limit=20",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "forecasts"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "页码"
                },
                {
                  "key": "limit",
                  "value": "20",
                  "description": "每页数量"
                },
                {
                  "key": "status",
                  "value": "",
                  "description": "状态筛选",
                  "disabled": true
                },
                {
                  "key": "mawb",
                  "value": "",
                  "description": "主运单号筛选",
                  "disabled": true
                },
                {
                  "key": "flight_no",
                  "value": "",
                  "description": "航班号筛选",
                  "disabled": true
                }
              ]
            },
            "description": "获取包含客户自己包裹的预报单列表"
          },
          "response": []
        },
        {
          "name": "按状态筛选预报单",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/forecasts?status=draft",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "forecasts"],
              "query": [
                {
                  "key": "status",
                  "value": "draft",
                  "description": "筛选草稿状态的预报单"
                }
              ]
            },
            "description": "按状态筛选预报单"
          },
          "response": []
        },
        {
          "name": "按主运单号筛选预报单",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/forecasts?mawb=MAWB250807001",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "forecasts"],
              "query": [
                {
                  "key": "mawb",
                  "value": "MAWB250807001",
                  "description": "按主运单号筛选"
                }
              ]
            },
            "description": "按主运单号筛选预报单"
          },
          "response": []
        }
      ],
      "description": "客户端预报单查询相关接口"
    },
    {
      "name": "04. 入站包裹管理",
      "item": [
        {
          "name": "添加包裹到入站",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.environment.set('last_package_id', responseJson.package.id);",
                  "    pm.environment.set('last_package_code', responseJson.package.package_code);",
                  "    console.log('Package created:', responseJson.package.package_code);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"length_cm\": 30,\n    \"width_cm\": 20,\n    \"height_cm\": 15,\n    \"weight_kg\": 2.5,\n    \"split_action\": \"direct\",\n    \"remark\": \"测试包裹\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/add-package",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "inbond",
                "{{inbond_id}}",
                "add-package"
              ]
            },
            "description": "向指定入站添加单个包裹"
          },
          "response": []
        },
        {
          "name": "批量添加包裹到入站",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"packages\": [\n        {\n            \"length_cm\": 30,\n            \"width_cm\": 20,\n            \"height_cm\": 15,\n            \"weight_kg\": 2.5,\n            \"split_action\": \"direct\",\n            \"remark\": \"测试包裹1\"\n        },\n        {\n            \"length_cm\": 25,\n            \"width_cm\": 25,\n            \"height_cm\": 20,\n            \"weight_kg\": 3.0,\n            \"split_action\": \"direct\",\n            \"remark\": \"测试包裹2\"\n        }\n    ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/add-packages-batch",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "inbond",
                "{{inbond_id}}",
                "add-packages-batch"
              ]
            },
            "description": "批量向入站添加多个包裹（最多200个）"
          },
          "response": []
        },
        {
          "name": "获取入站包裹列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/packages",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "inbond", "{{inbond_id}}", "packages"]
            },
            "description": "获取指定入站的所有包裹列表"
          },
          "response": []
        },
        {
          "name": "更新包裹信息",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"length_cm\": 35,\n    \"width_cm\": 25,\n    \"height_cm\": 20,\n    \"weight_kg\": 3.0,\n    \"split_action\": \"direct\",\n    \"remark\": \"更新后的包裹信息\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "package", "{{package_id}}"]
            },
            "description": "更新指定包裹的信息（仅限prepared状态的包裹）"
          },
          "response": []
        },
        {
          "name": "批量更新包裹",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"packages\": [\n        {\n            \"id\": 1,\n            \"length_cm\": 32,\n            \"width_cm\": 22,\n            \"height_cm\": 16,\n            \"weight_kg\": 2.8,\n            \"remark\": \"批量更新包裹1\"\n        },\n        {\n            \"id\": 2,\n            \"length_cm\": 28,\n            \"width_cm\": 26,\n            \"height_cm\": 18,\n            \"weight_kg\": 3.2,\n            \"remark\": \"批量更新包裹2\"\n        }\n    ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/packages-batch",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "packages-batch"]
            },
            "description": "批量更新多个包裹信息"
          },
          "response": []
        },
        {
          "name": "删除包裹",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "package", "{{package_id}}"]
            },
            "description": "删除指定包裹（仅限prepared状态的包裹）"
          },
          "response": []
        },
        {
          "name": "批量删除包裹",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"packageIds\": [1, 2, 3]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/packages-batch",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "packages-batch"]
            },
            "description": "批量删除多个包裹"
          },
          "response": []
        }
      ],
      "description": "入站包裹管理相关接口"
    },
    {
      "name": "05. 包裹项目管理",
      "item": [
        {
          "name": "添加包裹项目",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"tracking_no\": \"TRK123456789\",\n    \"client_code\": \"CLI001\",\n    \"file_number\": \"FILE001\",\n    \"receiver_name\": \"张三\",\n    \"receiver_country\": \"中国\",\n    \"receiver_state\": \"广东省\",\n    \"receiver_city\": \"深圳市\",\n    \"receiver_postcode\": \"518000\",\n    \"receiver_email\": \"zhang@example.com\",\n    \"receiver_phone\": \"13800138000\",\n    \"receiver_address1\": \"南山区科技园\",\n    \"sender_name\": \"发送者\",\n    \"sender_country\": \"美国\",\n    \"weight_kg\": 1.5,\n    \"quantity\": 1,\n    \"length_cm\": 20,\n    \"width_cm\": 15,\n    \"height_cm\": 10,\n    \"hs_code\": \"8471301000\",\n    \"product_name_en\": \"Computer Accessories\",\n    \"product_description\": \"USB Cable\",\n    \"origin_country\": \"中国\",\n    \"unit_price\": 25.00,\n    \"total_price\": 25.00,\n    \"item_count\": 1,\n    \"is_fda\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_code}}/add-item",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "package",
                "{{package_code}}",
                "add-item"
              ]
            },
            "description": "向指定包裹添加项目详情"
          },
          "response": []
        },
        {
          "name": "获取包裹项目列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/package/{{package_code}}/items",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "package", "{{package_code}}", "items"]
            },
            "description": "获取指定包裹的所有项目列表"
          },
          "response": []
        },
        {
          "name": "从Excel批量添加项目",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"items\": [\n        {\n            \"package_id\": 1,\n            \"tracking_no\": \"TRK123456789\",\n            \"client_code\": \"CLI001\",\n            \"receiver_name\": \"张三\",\n            \"receiver_country\": \"中国\",\n            \"receiver_city\": \"深圳市\",\n            \"product_name_en\": \"Computer Accessories\",\n            \"total_price\": 25.00\n        },\n        {\n            \"package_id\": 2,\n            \"tracking_no\": \"TRK987654321\",\n            \"client_code\": \"CLI002\",\n            \"receiver_name\": \"李四\",\n            \"receiver_country\": \"中国\",\n            \"receiver_city\": \"上海市\",\n            \"product_name_en\": \"Electronics\",\n            \"total_price\": 50.00\n        }\n    ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/add-items-from-excel",
              "host": ["{{base_url}}"],
              "path": [
                "api",
                "client",
                "inbond",
                "{{inbond_id}}",
                "add-items-from-excel"
              ]
            },
            "description": "从Excel批量导入项目到入站（最多1000个项目）"
          },
          "response": []
        },
        {
          "name": "获取入站所有项目",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/client/inbond/{{inbond_id}}/items",
              "host": ["{{base_url}}"],
              "path": ["api", "client", "inbond", "{{inbond_id}}", "items"]
            },
            "description": "获取入站的所有包裹项目（按包裹分组）"
          },
          "response": []
        }
      ],
      "description": "包裹项目管理相关接口"
    },
    {
      "name": "06. 系统接口",
      "item": [
        {
          "name": "系统健康检查",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/common/health",
              "host": ["{{base_url}}"],
              "path": ["api", "common", "health"]
            },
            "description": "检查系统健康状态"
          },
          "response": []
        },
        {
          "name": "获取税务类型",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{client_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/common/tax-types",
              "host": ["{{base_url}}"],
              "path": ["api", "common", "tax-types"]
            },
            "description": "获取可用的税务类型列表"
          },
          "response": []
        }
      ],
      "description": "系统相关的公共接口"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// 预请求脚本：设置通用请求头",
          "pm.request.headers.add({",
          "    key: 'Content-Type',",
          "    value: 'application/json'",
          "});"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// 全局测试脚本：检查响应状态",
          "pm.test('响应状态检查', function () {",
          "    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);",
          "});",
          "",
          "// 检查响应时间",
          "pm.test('响应时间检查', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(5000);",
          "});",
          "",
          "// 记录响应信息",
          "console.log('请求URL:', pm.request.url.toString());",
          "console.log('响应状态:', pm.response.code, pm.response.status);",
          "console.log('响应时间:', pm.response.responseTime + 'ms');"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "collection_name",
      "value": "TranSync Client API",
      "type": "string"
    },
    {
      "key": "version",
      "value": "1.0.0",
      "type": "string"
    },
    {
      "key": "created_date",
      "value": "2025-08-07",
      "type": "string"
    }
  ]
}
